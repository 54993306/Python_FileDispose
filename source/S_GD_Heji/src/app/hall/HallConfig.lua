cc.FileUtils:getInstance():purgeCachedEntries();
cc.Director:getInstance():getTextureCache():removeAllTextures()

package.loaded["app.DebugHelper"] = nil;
package.loaded["app.PayConfig"] = nil;
package.loaded["app.common.NativeCall"] = nil;
package.loaded["app.config"] = nil;
package.loaded["app.games.common.CommonAudioConfig"] = nil;
package.loaded["app.games.common.Define"] = nil;
package.loaded["app.games.common.GameConfig"] = nil;
package.loaded["app.games.common.common.Constants"] = nil;
package.loaded["app.games.common.common.EntityDef"] = nil;
package.loaded["app.games.common.common.EventDef"] = nil;
package.loaded["app.games.common.common.MessageDef"] = nil;
package.loaded["app.games.common.common.PartDef"] = nil;
package.loaded["app.games.common.common.PropImageDef"] = nil;
package.loaded["app.games.common.common.StateDef"] = nil;
package.loaded["app.games.common.common.SystemDef"] = nil;
package.loaded["app.games.common.components.SingleTouchSwallow"] = nil;
package.loaded["app.games.common.custom.CircleClippingNode"] = nil;
package.loaded["app.games.common.custom.DismissDeskView"] = nil;
package.loaded["app.games.common.custom.MJTricks"] = nil;
package.loaded["app.games.common.mahjong.EmptyMjBg"] = nil;
package.loaded["app.games.common.mahjong.LeftOut"] = nil;
package.loaded["app.games.common.mahjong.LeftPeng"] = nil;
package.loaded["app.games.common.mahjong.LeftPengTang"] = nil;
package.loaded["app.games.common.mahjong.Mj"] = nil;
package.loaded["app.games.common.mahjong.MjBase"] = nil;
package.loaded["app.games.common.mahjong.MyselfNormal"] = nil;
package.loaded["app.games.common.mahjong.MyselfOut"] = nil;
package.loaded["app.games.common.mahjong.MyselfPeng"] = nil;
package.loaded["app.games.common.mahjong.MyselfPengTang"] = nil;
package.loaded["app.games.common.mahjong.OtherOut"] = nil;
package.loaded["app.games.common.mahjong.OtherPeng"] = nil;
package.loaded["app.games.common.mahjong.OtherPengTang"] = nil;
package.loaded["app.games.common.mahjong.RightOut"] = nil;
package.loaded["app.games.common.mahjong.RightPeng"] = nil;
package.loaded["app.games.common.mahjong.RightPengTang"] = nil;
package.loaded["app.games.common.mediator.MjGameScene"] = nil;
package.loaded["app.games.common.mediator.MjGameSocketProcesser"] = nil;
package.loaded["app.games.common.mediator.MjMediator"] = nil;
package.loaded["app.games.common.proxy.MjProxy"] = nil;
package.loaded["app.games.common.ui.GameLayerBase"] = nil;
package.loaded["app.games.common.ui.UIFactory"] = nil;
package.loaded["app.games.common.ui.bglayer.MJToast"] = nil;
package.loaded["app.games.common.ui.bglayer.PlayerChat"] = nil;
package.loaded["app.games.common.ui.gameover.FriendOverView"] = nil;
package.loaded["app.games.common.ui.gameover.FriendTotalOverView"] = nil;
package.loaded["app.games.common.ui.operatelayer.MyselfTinPaiOperation"] = nil;
package.loaded["app.games.common.ui.playlayer.GamePlayLayer"] = nil;
package.loaded["app.games.common.ui.playlayer.Indicator"] = nil;
package.loaded["app.games.common.ui.playlayer.PlayerLeftPanel"] = nil;
package.loaded["app.games.common.ui.playlayer.PlayerOtherPanel"] = nil;
package.loaded["app.games.common.ui.playlayer.PlayerPanelBase"] = nil;
package.loaded["app.games.common.ui.playlayer.PlayerRightPanel"] = nil;
package.loaded["app.games.common.ui.playlayer.Robot"] = nil;
package.loaded["app.games.common.ui.playlayer.exhibition.MjGroupFactory"] = nil;
package.loaded["app.games.common.ui.playlayer.exhibition.MjGroups"] = nil;
package.loaded["app.games.common.utils.Deque"] = nil;
package.loaded["app.hall.HallConfig"] = nil;
package.loaded["app.hall.HallConstants"] = nil;
package.loaded["app.hall.common.AnimationManager"] = nil;
package.loaded["app.hall.common.ClientScrollview"] = nil;
package.loaded["app.hall.common.CommonAnimManager"] = nil;
package.loaded["app.hall.common.CommonDialog"] = nil;
package.loaded["app.hall.common.CommonTips"] = nil;
package.loaded["app.hall.common.CommonTipsDialog"] = nil;
package.loaded["app.hall.common.Deque"] = nil;
package.loaded["app.hall.common.GameConst"] = nil;
package.loaded["app.hall.common.GameManager"] = nil;
package.loaded["app.hall.common.IGameBase"] = nil;
package.loaded["app.hall.common.LibBit"] = nil;
package.loaded["app.hall.common.LibDropDownItem"] = nil;
package.loaded["app.hall.common.LibFont"] = nil;
package.loaded["app.hall.common.LibMultiLabel"] = nil;
package.loaded["app.hall.common.LibXmlParser"] = nil;
package.loaded["app.hall.common.LoadingView"] = nil;
package.loaded["app.hall.common.LocalEvent"] = nil;
package.loaded["app.hall.common.Log"] = nil;
package.loaded["app.hall.common.ObtainDialog"] = nil;
package.loaded["app.hall.common.PageViewWnd"] = nil;
package.loaded["app.hall.common.SelectRadioBtn"] = nil;
package.loaded["app.hall.common.SelectRadioPanel"] = nil;
package.loaded["app.hall.common.SliderIndicatorSprite"] = nil;
package.loaded["app.hall.common.SliderIndicatorWnd"] = nil;
package.loaded["app.hall.common.SoundManager"] = nil;
package.loaded["app.hall.common.Toast"] = nil;
package.loaded["app.hall.common.ToolKit"] = nil;
package.loaded["app.hall.common.TouchCaptureView"] = nil;
package.loaded["app.hall.common.UIManager"] = nil;
package.loaded["app.hall.common.UIWndBase"] = nil;
package.loaded["app.hall.common.CSBManager"] = nil;
package.loaded["app.hall.common.Util"] = nil;
package.loaded["app.hall.data.ChargeListInfo"] = nil;
package.loaded["app.hall.data.HallGiftInfo"] = nil;
package.loaded["app.hall.data.LoginInfo"] = nil;
package.loaded["app.hall.data.PlaybackInfo"] = nil;
package.loaded["app.hall.data.ServerInfo"] = nil;
package.loaded["app.hall.data.SettingInfo"] = nil;
package.loaded["app.hall.data.SystemConfig"] = nil;
package.loaded["app.hall.data.UserData_base"] = nil;
package.loaded["app.hall.data.UserData_giftInfo"] = nil;
package.loaded["app.hall.data.UserData_userExtInfo"] = nil;
package.loaded["app.hall.data.UserData_userInfo"] = nil;
package.loaded["app.hall.data.UserData_userPointInfo"] = nil;
package.loaded["app.hall.data.UserData_userRecordInfo"] = nil;
package.loaded["app.hall.data.UserInfo"] = nil;
package.loaded["app.hall.data.regionConfig"] = nil;
package.loaded["app.hall.friendRoom.FriendRoomCode"] = nil;
package.loaded["app.hall.friendRoom.FriendRoomCreate"] = nil;
package.loaded["app.hall.friendRoom.FriendRoomInfo"] = nil;
package.loaded["app.hall.friendRoom.FriendRoomPlayerHead"] = nil;
package.loaded["app.hall.friendRoom.FriendRoomRedPacket"] = nil;
package.loaded["app.hall.friendRoom.FriendRoomScene"] = nil;
package.loaded["app.hall.friendRoom.FriendRoomSocketProcesser"] = nil;
package.loaded["app.hall.friendRoom.OpenRoomGame"] = nil;
package.loaded["app.hall.friendRoom.OpenRoomGameOverUI"] = nil;
package.loaded["app.hall.friendRoom.ExchangeSeatTips"] = nil;
package.loaded["app.hall.friendRoom.SignalInfoNode"] = nil;
package.loaded["app.hall.main.HallLoading"] = nil;
package.loaded["app.hall.main.HallLogin"] = nil;
package.loaded["app.hall.main.HallMain"] = nil;
package.loaded["app.hall.main.HallUpdate"] = nil;
package.loaded["app.hall.main.HallMoreUpdate"] = nil;
package.loaded["app.hall.network.ByteStringAnalyze"] = nil;
package.loaded["app.hall.network.PacketBuffer"] = nil;
package.loaded["app.hall.network.RC4"] = nil;
package.loaded["app.hall.network.commonSocketProcesser"] = nil;
package.loaded["app.hall.network.httpManager"] = nil;
package.loaded["app.hall.network.socketCmd"] = nil;
package.loaded["app.hall.network.socketManager"] = nil;
package.loaded["app.hall.network.socketProcesser"] = nil;
package.loaded["app.hall.socket.GlobalDataProcesser"] = nil;
package.loaded["app.hall.socket.HallSocketCmd"] = nil;
package.loaded["app.hall.socket.HallSocketProcesser"] = nil;
package.loaded["app.hall.socket.UserDataProcesser"] = nil;
package.loaded["app.hall.videotape.VideotapeManager"] = nil;
package.loaded["app.hall.wnds.Contact_us"] = nil;
package.loaded["app.hall.wnds.FreeShareDialog"] = nil;
package.loaded["app.hall.wnds.FreeShareDialogDetail"] = nil;
package.loaded["app.hall.wnds.RecruitDialog"] = nil;
package.loaded["app.hall.wnds.PlayerListDialog"] = nil;
package.loaded["app.hall.wnds.about_us"] = nil;
package.loaded["app.hall.wnds.activity.ActivityDialog"] = nil;
package.loaded["app.hall.wnds.advert.AdvertView"] = nil;
package.loaded["app.hall.wnds.advert.AdvertViewDialog"] = nil;
package.loaded["app.hall.wnds.chat.RoomChatView"] = nil;
package.loaded["app.hall.wnds.club.ClubHeadList"] = nil;
package.loaded["app.hall.wnds.club.club"] = nil;
package.loaded["app.hall.wnds.club.clubApplyRecordWnd"] = nil;
package.loaded["app.hall.wnds.club.clubJoinedWnd"] = nil;
package.loaded["app.hall.wnds.club.clubSocketProcesser"] = nil;
package.loaded["app.hall.wnds.club.clubtips"] = nil;
package.loaded["app.hall.wnds.club.myclub"] = nil;
package.loaded["app.hall.wnds.club.clubRoomListWnd"] = nil;
package.loaded["app.hall.wnds.club.clubRoomModel"] = nil;
package.loaded["app.hall.wnds.club.clubRoomModelProcesser"] = nil;
package.loaded["app.hall.wnds.duty.Duty"] = nil;
package.loaded["app.hall.wnds.duty.ServerNoticeCfg"] = nil
package.loaded["app.hall.wnds.email.EmailContent"] = nil;
package.loaded["app.hall.wnds.email.EmailPanel"] = nil;
package.loaded["app.hall.wnds.email.EmailSocketProcesser"] = nil;
package.loaded["app.hall.wnds.account.PhoneLoginSocketProcesser"] = nil;
package.loaded["app.hall.wnds.account.AccountBindWechat"] = nil;
package.loaded["app.hall.wnds.account.AccountComFun"] = nil;
package.loaded["app.hall.wnds.account.AccountStatus"] = nil;
package.loaded["app.hall.wnds.account.ByPhoneLogin"] = nil;
package.loaded["app.hall.wnds.account.GetPassword"] = nil;
package.loaded["app.hall.wnds.account.PhoneLogin"] = nil;
package.loaded["app.hall.wnds.account.PhoneLoginSocketProcesser"] = nil;
package.loaded["app.hall.wnds.account.phoneRegistPanel"] = nil;
package.loaded["app.hall.wnds.account.BindPanel"] = nil;
package.loaded["app.hall.wnds.account.BindPhone"] = nil;
package.loaded["app.hall.wnds.account.ChangePassword"] = nil;
package.loaded["app.hall.wnds.account.HallBindPhone"] = nil;
package.loaded["app.hall.wnds.account.NotarizePanel"] = nil;
package.loaded["app.hall.wnds.helpWnd"] = nil;
package.loaded["app.hall.wnds.mall.MallRecordPanel"] = nil;
package.loaded["app.hall.wnds.mall.MallTrophyPanel"] = nil;
package.loaded["app.hall.wnds.mall.mall"] = nil;
package.loaded["app.hall.wnds.mall.mallPlayerInfo"] = nil;
package.loaded["app.hall.wnds.mall.mallSocketProcesser"] = nil;
package.loaded["app.hall.wnds.mall.mallTest"] = nil;
package.loaded["app.hall.wnds.mall.redPacketPanel"] = nil;
package.loaded["app.hall.wnds.mall.redPacketPath"] = nil;
package.loaded["app.hall.wnds.newer.NewerTipsWnd"] = nil;
package.loaded["app.hall.wnds.newer.NewerTipsWnd1"] = nil;
package.loaded["app.hall.wnds.newer.NewerTipsWnd2"] = nil;
package.loaded["app.hall.wnds.notice.NoticeWnd"] = nil;
package.loaded["app.hall.wnds.player.PlayerPanel"] = nil;
package.loaded["app.hall.wnds.player.PlayerSocketProcesser"] = nil;
package.loaded["app.hall.wnds.playerInfo.PlayerPosInfoWnd"] = nil;
package.loaded["app.hall.wnds.quickpay.quickpaySelectPayType"] = nil;
package.loaded["app.hall.wnds.quickpay.quickpayment"] = nil;
package.loaded["app.hall.wnds.ranking.RankingAddressNameInfo"] = nil;
package.loaded["app.hall.wnds.ranking.RankingConfirmInfo"] = nil;
package.loaded["app.hall.wnds.ranking.RankingInfo"] = nil;
package.loaded["app.hall.wnds.ranking.RankingMatchUI"] = nil;
package.loaded["app.hall.wnds.ranking.RankingNode"] = nil;
package.loaded["app.hall.wnds.ranking.RankingRewardInfo"] = nil;
package.loaded["app.hall.wnds.ranking.RankingSocketProcesser"] = nil;
package.loaded["app.hall.wnds.ranking.RankingSpecification"] = nil;
package.loaded["app.hall.wnds.ranking.RankingSystem"] = nil;
package.loaded["app.hall.wnds.realName.RealName"] = nil;
package.loaded["app.hall.wnds.record.MatchRecordDialog"] = nil;
package.loaded["app.hall.wnds.record.RecordDialog"] = nil;
package.loaded["app.hall.wnds.rule.RuleDialog"] = nil;
package.loaded["app.hall.wnds.selectCity.ConfirmCityWnd"] = nil;
package.loaded["app.hall.wnds.selectCity.SelectCityWnd"] = nil;
package.loaded["app.hall.wnds.selectServer.SelectServerWnd"] = nil;
package.loaded["app.hall.wnds.set.HallSetDialog"] = nil;
package.loaded["app.hall.wnds.share.ShareDialog"] = nil;
package.loaded["app.hall.wnds.tipDialog.TopTip"] = nil
package.loaded["app.hall.wnds.tipDialog.TopTipScheduler"] = nil
package.loaded["app.hall.wnds.yaoqing.InviteFriendView"] = nil;
package.loaded["app.hall.wnds.yaoqing.YaoqingDialog"] = nil;
package.loaded["app.hall.wnds.yaoqing.YaoqingDialogDetail"] = nil;
package.loaded["app.hall.wnds.yaoqing.YaoqingSocketProcesser"] = nil;
package.loaded["app.scenes.MainScene"] = nil;
package.loaded["app.games.common.MjGameConfigManager"] = nil;
package.loaded["app.games.common.MjGameConfigManager"] = nil;
package.loaded["app.games.common.custom.GameRoomInfoUIBase"] = nil;
package.loaded["app.hall.common.ShareToWX"] = nil;
package.loaded["app.hall.data.HallAPI"] = nil;
package.loaded["app.common.UmengClickEvent"] = nil;
package.loaded["app.common.FileLog"] = nil;
-- wechat share
-- package.loaded["app.hall.common.share.aes.aeslua"] = nil;
package.loaded["app.hall.common.share.wechatShare"] = nil;

if IsPortrait then -- TODO
    package.loaded["app.common.UITool"] = nil;
    package.loaded["app.hall.common.ClientScrollBar"] = nil
    package.loaded["app.hall.friendRoom.FriendRoomEnterInfo"] = nil;
    package.loaded["app.hall.data.HallAPI"] = nil;
    package.loaded["app.common.UmengClickEvent"] = nil;
end


PRODUCT_ID = nil;

require("app.config");

if PRODUCT_ID == nil then
    local errorMessage = [[
        原来CONFIG_GAEMID既代表默认麻将ID，又代表产品ID，现在将其含义进行分离。
        CONFIG_GAEMID 含义变更为默认的麻将ID
        PRODUCT_ID 产品ID标志不同的包
        请确认config.lua中是否已经配置了PRODUCT_ID
        ]]
    device.showAlert("PRODUCT_ID ERROR", tostring(errorMessage), "OK")
end

require("app.hall.common.Log")
require("app.common.NativeCall");
if IsPortrait then -- TODO
require("app.common.UITool")
end
require("app.games.common.GameConfig");
require("app.PayConfig");
require("app.hall.HallConstants");
require("app.hall.common.UIWndBase")
if IsPortrait then -- TODO
require("app.hall.common.UIManager")
end
require("app.hall.common.CSBManager");
require("app.hall.common.GameConst");
require("app.hall.data.regionConfig");
require("app.hall.common.Util");
require("app.hall.common.LibXmlParser");
require("app.hall.common.LibFont");
require("app.hall.common.LibBit");
require("app.hall.common.LibMultiLabel");
require("app.hall.socket.HallSocketCmd");
require("app.hall.network.PacketBuffer");
require("app.hall.network.socketProcesser");
require("app.hall.network.socketManager");
require("app.hall.network.httpManager");
require("app.hall.data.ServerInfo");
require("app.hall.socket.UserDataProcesser");
require("app.hall.data.UserData_base");
require("app.hall.data.UserData_userInfo");
require("app.hall.data.UserData_userExtInfo");
require("app.hall.data.UserData_userPointInfo");
require("app.hall.data.UserData_userRecordInfo");
require("app.hall.data.UserData_giftInfo");
require("app.hall.data.UserInfo");
require("app.hall.data.LoginInfo");
require("app.hall.data.ChargeListInfo");
require("app.hall.data.SystemConfig");
require("app.hall.data.SettingInfo");
require("app.hall.data.PlaybackInfo");
require("app.hall.data.HallGiftInfo");
require("app.hall.common.GameManager");
if IsPortrait then -- TODO
require("app.hall.common.CSBManager");
end
require("app.hall.common.SoundManager");
require("app.hall.common.CommonAnimManager");
require("app.hall.common.AnimationManager");
require("app.hall.socket.HallSocketProcesser");
require("app.hall.main.HallLoading");
require("app.hall.main.HallLogin");
require("app.hall.main.HallUpdate");
require("app.hall.main.HallMoreUpdate");
require("app.hall.main.HallMain");
require("app.hall.common.TouchCaptureView");
require("app.hall.common.CommonTipsDialog");
require("app.hall.common.ClientScrollview");
if IsPortrait then -- TODO
require("app.hall.common.ClientScrollBar");
end
require("app.hall.common.SelectRadioPanel")
require("app.hall.common.SelectRadioBtn")
require("app.hall.wnds.newer.NewerTipsWnd");
require("app.hall.wnds.newer.NewerTipsWnd1");
require("app.hall.wnds.newer.NewerTipsWnd2");
require("app.hall.wnds.yaoqing.YaoqingSocketProcesser");
require("app.hall.wnds.FreeShareDialog");
require("app.hall.wnds.Contact_us");
require("app.hall.wnds.about_us");
require("app.hall.wnds.email.EmailPanel");
require("app.hall.wnds.email.EmailContent");
if IsPortrait then -- TODO
require("app.hall.wnds.email.EmailSocketProcesser");
end
require("app.hall.wnds.FreeShareDialogDetail");
require("app.hall.wnds.RecruitDialog");
require("app.hall.wnds.yaoqing.YaoqingDialog");
require("app.hall.wnds.yaoqing.YaoqingDialogDetail");
require("app.hall.wnds.record.RecordDialog");
require("app.hall.wnds.record.MatchRecordDialog");
require("app.hall.wnds.rule.RuleDialog");
require("app.hall.wnds.set.HallSetDialog");
require("app.hall.wnds.quickpay.quickpayment");
require("app.hall.wnds.share.ShareDialog");
require("app.hall.videotape.VideotapeManager");
require("app.hall.wnds.chat.RoomChatView");
if IsPortrait then -- TODO
require("app.hall.friendRoom.FriendRoomEnterInfo")
end
require("app.hall.friendRoom.FriendRoomCreate")
require("app.hall.friendRoom.FriendRoomCode");
require("app.hall.friendRoom.SignalInfoNode")
require("app.hall.friendRoom.FriendRoomScene");
require("app.hall.friendRoom.ExchangeSeatTips")
require("app.hall.friendRoom.FriendRoomPlayerHead");
require("app.hall.friendRoom.FriendRoomSocketProcesser");
require("app.hall.friendRoom.FriendRoomInfo");
require("app.hall.friendRoom.OpenRoomGameOverUI")
require("app.hall.friendRoom.OpenRoomGame");
require("app.hall.friendRoom.FriendRoomRedPacket");
require("app.hall.wnds.playerInfo.PlayerPosInfoWnd");
require("app.hall.wnds.advert.AdvertView");
require("app.hall.wnds.advert.AdvertViewDialog");
require("app.hall.wnds.notice.NoticeWnd");
require("app.hall.wnds.selectServer.SelectServerWnd")
require("app.hall.wnds.ranking.RankingMatchUI");
require("app.hall.wnds.ranking.RankingSpecification");
require("app.hall.wnds.ranking.RankingConfirmInfo");
require("app.hall.wnds.ranking.RankingInfo");
require("app.hall.wnds.ranking.RankingNode");
require("app.hall.wnds.ranking.RankingRewardInfo");
require("app.hall.wnds.ranking.RankingAddressNameInfo");
require("app.hall.wnds.ranking.RankingSocketProcesser");
require("app.hall.wnds.ranking.RankingSystem");
require("app.hall.wnds.club.clubRoomListWnd");
require("app.hall.wnds.club.clubRoomModel");
require("app.hall.wnds.club.clubRoomModelProcesser");
require("app.hall.wnds.selectCity.SelectCityWnd")
require("app.hall.wnds.selectCity.ConfirmCityWnd")
require("app.games.common.MjGameConfigManager")
require("app.games.common.custom.GameRoomInfoUIBase")
require("app.hall.common.ShareToWX");
-- wechat share
-- require("app.hall.common.share.aes.aeslua")
require("app.hall.common.share.wechatShare")
require("app.common.UmengClickEvent")
require("app.hall.wnds.email.EmailSocketProcesser")
HallAPI = require("app.hall.data.HallAPI")

GC_HALL_VERSION = "3.5.3.0"

kPreGameType = nil

if IsPortrait then -- TODO
    GC_HALL_VERSION = "3.6.2.0"
    UIManager.getInstance():recoverToDesignOrient()
end

function loadGame(gameId)
    local gameType = GC_GameTypes[gameId]
    if not gameType then
        return false
    end
    -- 设置游戏房间信息
    _gameType = gameType
    --SettingInfo.getInstance():setSelectAreaGameID(gameId)
    local tAreaDataTable = kFriendRoomInfo:getAreaBaseInfo()
    for k, v in pairs(tAreaDataTable) do
        if v.gameId == gameId then
            kFriendRoomInfo:setRoomBaseInfo(v)
        end
    end
    if kPreGameType then
        if kPreGameType == gameType then
            return true
        end
        local pathName = kPreGameType;
        Log.i("------kPreGameType", pathName);
        local gameName = string.upper(pathName);
        -- release game file
        releaseAndLoadFiles(kPreGameType, false)
    end
    local pathName = gameType;
    Log.i("------gameType", pathName);
    local gameName = string.upper(pathName);

    -- load common file
    loadGameCommonFile()
    -- load game file
    releaseAndLoadFiles(gameType, true)
    kPreGameType = gameType
    return true
end

function releaseAndLoadFiles(gameType, loadThisGame)
    local pathName = gameType
    local gameName = string.upper(pathName)

    --跑的快特殊处理
    local tmpGameName = gameType
    if gameType == "pdkpk" then
    	pathName = "paodekuai."..gameType
    	gameName = string.upper(tmpGameName)
    elseif gameType == "gdpk" then
        pathName = "guandan."..gameType
        gameName = string.upper(tmpGameName)
    end

    if loadThisGame then
        -- 释放config文件
        package.loaded["package_src.games." .. pathName .. ".GameConfig"] = nil;
        package.loaded["package_src.games." .. pathName .. "." .. gameName .. "Config"] = nil;
        -- 加载config文件
        require("package_src.games." .. pathName .. ".GameConfig")
        require("package_src.games." .. pathName .. "." .. gameName .. "Config")
        -- 释放common资源
        for k, v in pairs(GC_GameFiles["common"]) do
            package.loaded[v] = nil
        end
        -- 释放game资源
        for k, v in pairs(GC_GameFiles["game"]) do
            package.loaded[v] = nil
        end
        -- 加载game资源
        for k, v in pairs(GC_GameFiles["game"]) do
            require(v)
        end
    else
        -- 释放common资源
        for k, v in pairs(GC_GameFiles["common"]) do
            package.loaded[v] = nil
        end
        -- 释放game资源
        for k, v in pairs(GC_GameFiles["game"]) do
            package.loaded[v] = nil
        end
        -- 加载common资源
        for k, v in pairs(GC_GameFiles["common"]) do
            require(v)
        end
        -- 释放config文件
        package.loaded["package_src.games." .. pathName .. ".GameConfig"] = nil;
        package.loaded["package_src.games." .. pathName .. "." .. gameName .. "Config"] = nil;
    end
end

function loadGameCommonFile()
    package.loaded["app.hall.wnds.set.HallSetDialog"] = nil

    package.loaded["app.games.common.common.EntityDef"] = nil
    package.loaded["app.games.common.common.EventDef"] = nil
    package.loaded["app.games.common.common.MessageDef"] = nil
    package.loaded["app.games.common.common.PartDef"] = nil
    package.loaded["app.games.common.common.StateDef"] = nil
    package.loaded["app.games.common.common.SystemDef"] = nil

    package.loaded["app.games.common.components.EvetServer"] = nil

    package.loaded["app.games.common.ui.playlayer.exhibition.LayoutAnGang"] = nil
    package.loaded["app.games.common.ui.playlayer.exhibition.LayoutChiPeng"] = nil
    package.loaded["app.games.common.ui.playlayer.exhibition.LayoutMingGame"] = nil
    package.loaded["app.games.common.ui.playlayer.exhibition.MjGroupBase"] = nil
    package.loaded["app.games.common.ui.playlayer.exhibition.MjGroupFactory"] = nil
    package.loaded["app.games.common.ui.playlayer.exhibition.MjGroups"] = nil
    package.loaded["app.games.common.ui.gamelayer.GameLayer"] = nil

    package.loaded["app.games.common.ui.UIFactory"] = nil

    package.loaded["app.games.common.custom.MjTool"] = nil
    package.loaded["app.games.common.custom.MjTricks"] = nil
    package.loaded["app.games.common.custom.MjTurnLaizigou"] = nil

    package.loaded["app.games.common.mahjong.MyselfNormal"] = nil
    package.loaded["app.games.common.mahjong.Mj"] = nil

    package.loaded["app.games.common.ui.playlayer.PlayerPanelBase"] = nil
    package.loaded["app.games.common.ui.playlayer.PlayerLeftPanel"] = nil
    package.loaded["app.games.common.ui.playlayer.PlayerRightPanel"] = nil
    package.loaded["app.games.common.ui.playlayer.PlayerOtherPanel"] = nil
    package.loaded["app.games.common.ui.playlayer.HandCardsPanel"] = nil
    package.loaded["app.games.common.ui.playlayer.GamePlayLayer"] = nil

    package.loaded["app.hall.friendRoom.OpenRoomGame"] = nil
    package.loaded["app.games.common.mediator.MjGameScene"] = nil

    package.loaded["app.games.common.ui.UIFactory"] = nil

    package.loaded["app.games.common.common.Constants"] = nil
    package.loaded["app.games.common.proxy.MjProxy"] = nil
    package.loaded["app.games.common.mediator.MjMediator"] = nil
    package.loaded["app.games.common.custom.DismissDeskView"] = nil
    package.loaded["app.games.common.ui.gameover.FriendOverView"] = nil
    package.loaded["app.games.common.ui.gameover.FriendTotalOverView"] = nil
    package.loaded["app.games.common.ui.bglayer.PlayerChat"] = nil
    package.loaded["app.games.common.CommonAudioConfig"] = nil


    package.loaded["app.games.common.GameConfig"] = nil;
    require("app.games.common.GameConfig");

    require("app.hall.wnds.set.HallSetDialog");

    require("app.games.common.common.Constants")
    require "app.games.common.proxy.MjProxy"
    require("app.games.common.mediator.MjMediator")
    require("app.games.common.custom.DismissDeskView")
    require("app.games.common.ui.gameover.FriendTotalOverView")
    require("app.games.common.ui.gameover.FriendOverView")
    require("app.games.common.ui.bglayer.PlayerChat")
    require("app.games.common.CommonAudioConfig")
end

package.loaded["app.resourceCheck"] = nil;
local ResourceCheck = require("app.resourceCheck")
ResourceCheck.check()

--加载默认子游戏模块
loadGame(CONFIG_GAEMID);

function __G__TRACKBACK__(errorMessage)
    if device.platform == "android" then
        local message = tostring(errorMessage)
        if GC_GameName then
            message = GC_GameName .. message
        end
        buglySetTag(67252) -- __G__TRACKBACK__
        if kUserInfo and kUserInfo.getUserId and kUserInfo:getUserId() ~= 0 then
            buglyLog(2, "UserID", kUserInfo:getUserId())
        end
        buglyReportLuaException(message, debug.traceback())
    end
    print("----------------------------------------")
    print("LUA ERROR: " .. tostring(errorMessage) .. "\n")
    print(debug.traceback("", 2))
    print("----------------------------------------")
    Log.s("[ERROR] " .. tostring(errorMessage) .. "\n")
    Log.s(debug.traceback("", 2))
    Log.s("\n---------------DeviceInfo---------------"
        .. "\nIMEI: " .. tostring(IMEI)
        .. "\nMODEL: " .. tostring(MODEL)
        .. "\nREGION: " .. tostring(REGION)
        .. "\nSPID: " .. tostring(SPID)
        .. "\nVERSION: " .. tostring(VERSION)
        .. "\nNETMODE: " .. tostring(NETMODE)
        .. "\nJINDU: " .. tostring(JINDU)
        .. "\nWEIDU: " .. tostring(WEIDU)
        .. "\nENTERROOMCODE: " .. tostring(ENTERROOMCODE)
        .. "\nPAGENAME: " .. tostring(PAGENAME))
    -- if device.platform == "windows" or device.platform == "mac" then
    if DEBUG_MODE then
        device.showAlert("LUA ERROR", tostring(errorMessage)..debug.traceback("", 2), "OK")
    end
    return errorMessage
end
